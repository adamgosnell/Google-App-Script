/**
 * The following is a sample snippet for a simple notification function. 
 * The bound spreadsheet has a particular cell (F3) that, by an internal formula, 
 * whether a reconciliation is needed. Additionally, I've started to add a 
 * runValue variable to all my sheets. It's a kind of "master switch" for scripts
 * on a given sheet, so that someone can "turn them off" later, even if I'm not available. 
 */

function reconciliationNeededNotification() {
  var ss = SpreadsheetApp.getActiveSpreadsheet(); // gets the bound spreadsheet
  var sheet = ss.getSheetByName('Summary'); // gets the sheet in question
  var runValue = sheet.getRange("F2").getValue(); // gets the runValue
  var needed = sheet.getRange("F3").getValue(); // gets whether a reconciliation is needed
  var email = sheet.getRange("F4").getValue(); // gets the "in case a reconciliation is needed, notify..." field value

  console.log("runValue: " + runValue); // log the runValue for debugging
  console.log("needed: " + needed); // log the needed for debugging
  console.log("email: " + email); // log the email for debugging

  if (runValue == "YES") { // if the value from F2 indicates the script should run
    if (needed == true) { // if the value from F3 indicates a reconciliation is needed
      GmailApp.sendEmail( // send an email...
        email, // ...to the email fetched from F4
        "ACTION NEEDED: Gosnell - Reconciliation of Transfers", // ... with this subject
        "The following spreadsheet's automation indicates that a Reconciliation of Transfers is needed:\nhttps://docs.google.com/spreadsheets/d/[...]", // ... with this body (url redacted)
        {
          from: "donotreply@[...]", // ... send it from this email (organization redacted)
          name: "[...] Automation System", // ... send it from this name (organization redacted)
        }
      )
    }
  }
}
